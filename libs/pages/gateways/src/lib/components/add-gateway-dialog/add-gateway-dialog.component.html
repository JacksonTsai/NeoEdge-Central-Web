<h1 mat-dialog-title class="gl-h6">Add Gateway</h1>
<mat-dialog-content>
  @if (!enrollCommand()) {
    <form [formGroup]="form">
      <h4>Gateway type</h4>
      <div class="select-ipc-type">
        <mat-radio-group color="primary" aria-label="Select IPC option" [formControl]="isPartnerIpcCtrl">
          <mat-radio-button [value]="gatewayType.PARTNER">Certified IPC</mat-radio-button>
          <mat-radio-button [value]="gatewayType.OTHER">Others</mat-radio-button>
        </mat-radio-group>
      </div>
      <mat-form-field appearance="outline" floatLabel="always">
        <mat-label>
          @if (isPartner) {
            Partners
          } @else {
            Vendor
          }
        </mat-label>
        @if (isPartner) {
          <mat-select formControlName="ipcVendorName">
            @for (partnerName of partnerIpcOpt; track partnerName) {
              <mat-option [value]="partnerName"> {{ partnerName }} </mat-option>
            }
          </mat-select>
        } @else {
          <input matInput formControlName="ipcVendorName" type="text" maxlength="64" />
        }
        @if (isPartnerIpcCtrl.hasError('required')) {
          <mat-error>Required.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always">
        <mat-label> Model </mat-label>
        @if (isPartner) {
          <mat-select formControlName="ipcModelName">
            @for (partnerModel of partnerModelByIpcOpts; track partnerModel.seriesName) {
              <mat-option [value]="partnerModel"> {{ partnerModel.model }} </mat-option>
            }
          </mat-select>
        } @else {
          <input matInput formControlName="ipcModelName" type="text" maxlength="64" />
        }
        @if (ipcVendorNameCtrl.hasError('required')) {
          <mat-error>Required.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always">
        <mat-label>Name</mat-label>
        <input matInput formControlName="name" type="text" maxlength="128" />
        @if (nameCtrl.hasError('required')) {
          <mat-error>Required.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always">
        <mat-label>OS Version</mat-label>
        <mat-select formControlName="os">
          @for (os of osOpts; track os.id) {
            <mat-option [value]="os"> {{ os.name }} </mat-option>
          }
        </mat-select>
      </mat-form-field>
    </form>
  } @else {
    <div class="enroll-gw">
      <div class="item">
        <div class="label">Vendor</div>
        <div class="value">
          {{ enrollCommand().ipcVendorName }}
        </div>
      </div>

      <div class="item">
        <div class="label">Model</div>
        <div class="value">
          {{ enrollCommand().ipcModelName }}
        </div>
      </div>

      <div class="item">
        <div class="label">Gateway Name</div>
        <div class="value">
          {{ enrollCommand().name }}
        </div>
      </div>

      <div class="item">
        <div class="label">OS</div>
        <div class="value">
          {{ osCtrl.value.name }}
        </div>
      </div>

      <div class="item">
        <div class="label">Enrollment Command</div>
        <div class="value enroll-command">
          <mat-form-field class="login-form-field" appearance="outline" floatLabel="always">
            <mat-label>command</mat-label>
            <input
              matInput
              formControlName="account"
              type="text"
              maxlength="128"
              [value]="enrollCommand().command"
              disabled="true"
            />
          </mat-form-field>
          <button type="button" mat-icon-button color="primary" (click)="copyCommand()">
            <mat-icon svgIcon="icon:copy_gary"></mat-icon>
          </button>
        </div>
      </div>

      <h5 class="tip tip--warning">
        On Gateway ssh console, run above command to install NeoEdge X. The command will expired in
        {{ enrollCommand().commandEffectiveHour }}
        hours.
      </h5>
    </div>
  }
</mat-dialog-content>

<mat-dialog-actions class="dialog__action">
  @if (!enrollCommand()) {
    <button type="button" mat-stroked-button mat-dialog-close>Cancel</button>
    <button type="button" mat-raised-button color="primary" (click)="onSubmit()" [disabled]="form.invalid">
      Submit
    </button>
  } @else {
    <button type="button" mat-stroked-button mat-dialog-close>Close</button>
  }
</mat-dialog-actions>
