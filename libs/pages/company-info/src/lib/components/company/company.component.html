<h1 class="page-title">Company Info</h1>
<mat-card class="comp-info-card">
  <form [formGroup]="form">
    <div class="comp-info-wrapper">
      <div class="comp-info-wrapper__left">
        <div class="comp-img">
          @if (isEditMode()) {
          <div class="change-img" (click)="inputFile.click()">
            <mat-icon svgIcon="icon:camera_white" matTooltip="Change company logo."></mat-icon>
          </div>
          } @if (companyLogo() !== '') {
          <img width="100%" height="100%" [src]="companyLogo()" />
          }
          <input
            #inputFile
            type="file"
            class="file-input"
            (click)="inputFile.value = null"
            accept="image/gif,image/jpeg,image/jpg,image/png"
          />
        </div>
        <h3>
          {{ companyProfile?.name ? companyProfile?.name : '-' }}
        </h3>
        <h5>
          {{ companyProfile?.shortName ? companyProfile.shortName : '-' }}
        </h5>
        <div class="item item__first">
          <div class="label">Web Site</div>
          <div class="value">
            {{ companyProfile?.website ? companyProfile?.website : '-' }}
          </div>
        </div>
        <div class="item">
          <div class="label">Subscription Plan</div>
          <div class="value">
            {{ companyProfile?.planId > 0 ? subscriptionPlan[companyProfile?.planId] : '-' }}
          </div>
        </div>

        <div class="item">
          <div class="label">Start Time and End Time</div>
          <div class="value">
            <span> {{ getDatetimeFormat(companyProfile.agreementBegin) }} </span>
            ~
            <span> {{ getDatetimeFormat(companyProfile.agreementEnd) }}</span>
          </div>
        </div>

        <div class="item">
          <div class="label">Host Name</div>
          <div class="value">
            {{ companyProfile?.fqdn ? companyProfile?.fqdn : '-' }}
          </div>
        </div>

        <div class="item">
          <div class="label">Account Status</div>
          <div class="value">
            {{ companyStatus[companyProfile?.status] }}
          </div>
        </div>
      </div>
      <div class="comp-info-wrapper__right">
        <h2 class="comp-info-wrapper__right__subtitle">Business Contact</h2>
        <div class="edit-user">
          <mat-form-field appearance="outline" floatLabel="always">
            <mat-label> User Name</mat-label>
            <input matInput formControlName="bizContactName" type="text" maxlength="64" />
            @if (bizContactNameCtrl.hasError('required')) {
            <mat-error>Required.</mat-error>
            }
          </mat-form-field>
          <mat-form-field appearance="outline" floatLabel="always">
            <mat-label> Email</mat-label>
            <input matInput formControlName="bizContactEmail" type="text" maxlength="64" />
            @if (bizContactEmailCtrl.hasError('required')) {
            <mat-error>Required.</mat-error>
            } @if (bizContactEmailCtrl.hasError('email') && !bizContactEmailCtrl.hasError('required')) {
            <mat-error> Please enter a valid email address </mat-error>
            }
          </mat-form-field>

          <h2 class="comp-info-wrapper__right__subtitle">Technical Contact</h2>
          <mat-form-field appearance="outline" floatLabel="always">
            <mat-label> User Name</mat-label>
            <input matInput formControlName="techContactName" type="text" maxlength="64" />
            @if (techContactNameCtrl.hasError('required') || techContactNameCtrl.hasError('pattern')) {
            <mat-error>Required.</mat-error>
            }
          </mat-form-field>
          <mat-form-field appearance="outline" floatLabel="always">
            <mat-label> Email</mat-label>
            <input matInput formControlName="techContactEmail" type="text" maxlength="64" />
            @if (techContactEmailCtrl.hasError('required')) {
            <mat-error>Required.</mat-error>
            } @if (techContactEmailCtrl.hasError('email') && !techContactEmailCtrl.hasError('required')) {
            <mat-error> Please enter a valid email address </mat-error>
            }
          </mat-form-field>
        </div>
        <h2 class="comp-info-wrapper__right__subtitle">Language / Country /Date Format</h2>
        <div class="edit-other">
          <mat-form-field class="edit-other" appearance="outline" floatLabel="always">
            <mat-label>Language</mat-label>
            <mat-select formControlName="language">
              @for (lang of langOpts |keyvalue ; track lang.key) {
              <mat-option [value]="lang.key"> {{ lang.value }} </mat-option>
              }
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" floatLabel="always">
            <mat-label>Country</mat-label>
            <mat-select formControlName="country">
              @for (region of regionOpts | keyvalue ; track region.key) {
              <mat-option [value]="region.value"> {{ region.value }} </mat-option>
              }
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" floatLabel="always">
            <mat-label>Date-Time Format</mat-label>
            <mat-select formControlName="datetimeFormat">
              @for (format of dateFormatOpts | keyvalue ; track format.key) {
              <mat-option [value]="format.value"> {{ format.value }} </mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>
        <div class="company-info-action">
          <div class="edit-btn">
            @if (!isEditMode()) {
            <button type="button" mat-stroked-button color="primary" (click)="onEdit()">
              <mat-icon svgIcon="icon:edit_primary"></mat-icon>
              Edit
            </button>
            }
          </div>
          @if (isEditMode()) {
          <div class="save-btn">
            <button type="button" mat-stroked-button color="primary" (click)="onCancelEdit()">Cancel</button>
            <button
              type="button"
              mat-flat-button
              color="primary"
              (click)="onSave()"
              [disabled]="form.invalid || form.pristine"
            >
              Save
            </button>
          </div>
          }
        </div>
      </div>
    </div>
  </form>
</mat-card>
